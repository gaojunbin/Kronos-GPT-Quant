<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kronos Live Forecast | BTC/USDT</title>
    <link rel="icon" type="image/png" href="img/logo.png">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="container">
            <h1 class="project-title">Kronos: Live Forecast Dashboard</h1>
        </div>
    </header>

    <main class="container">
        <!-- Section 1: The Live Dashboard -->
        <section id="live-dashboard">
            <div class="metadata">
                <span>Last Updated (SGT): <strong id="update-time">2025-09-29 20:22:25</strong></span>
                <span>Data Source: Binance | Interval: 1-Hour</span>
            </div>

            <!-- 币种选择器 -->
            <div class="symbol-selector">
                <label for="symbol-select">选择币种: </label>
                <select id="symbol-select">
                    <option value="BNBUSDT">BNB/USDT</option>
                    <option value="ETHUSDT">ETH/USDT</option>
                    <option value="BTCUSDT">BTC/USDT</option>
                    <option value="SOLUSDT">SOL/USDT</option>
                    <option value="DOGEUSDT">DOGE/USDT</option>
                    <option value="ADAUSDT">ADA/USDT</option>
                </select>
            </div>

            <div class="metrics-container">
                <div class="metric-card">
                    <h3>Upside Probability (Next 24h)</h3>
                    <p class="metric-value" id="upside-prob">50.0%</p>
                    <div class="metric-desc">The model's confidence that the price in 24 hours will be higher than the last known price.</div>
                </div>
                <div class="metric-card">
                    <h3>Volatility Amplification (Next 24h)</h3>
                    <p class="metric-value" id="vol-amp-prob">96.7%</p>
                    <div class="metric-desc">The probability that predicted volatility over the next 24h will exceed recent historical volatility.</div>
                </div>
            </div>

            <div class="chart-wrapper">
                <h3>24-Hour Probabilistic Forecast</h3>
                <p>The chart below shows the historical price (blue) and the probabilistic forecast (orange). The orange line is the mean of multiple Monte Carlo simulations, and the shaded area represents the full range of predicted outcomes, indicating forecast uncertainty.</p>
                <div class="chart-container">
                    <img id="chart-img" src="charts/prediction_chart_BNBUSDT.png" alt="Cryptocurrency Price and Volume Forecast Chart" class="chart-img">
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 The Kronos Project. Licensed under the MIT License.</p>
        </div>
    </footer>

    <script>
        // 静态预测数据
        let predictionsData = {
            "last_updated": "2025-09-29 20:18:29",
            "symbols": {
                        "BNBUSDT": {
                                    "upside_prob": "50.0%",
                                    "vol_amp_prob": "96.7%",
                                    "chart_file": "charts/prediction_chart_BNBUSDT.png"
                        },
                        "ETHUSDT": {
                                    "upside_prob": "43.3%",
                                    "vol_amp_prob": "23.3%",
                                    "chart_file": "charts/prediction_chart_ETHUSDT.png"
                        },
                        "BTCUSDT": {
                                    "upside_prob": "23.3%",
                                    "vol_amp_prob": "16.7%",
                                    "chart_file": "charts/prediction_chart_BTCUSDT.png"
                        },
                        "SOLUSDT": {
                                    "upside_prob": "33.3%",
                                    "vol_amp_prob": "70.0%",
                                    "chart_file": "charts/prediction_chart_SOLUSDT.png"
                        },
                        "DOGEUSDT": {
                                    "upside_prob": "50.0%",
                                    "vol_amp_prob": "73.3%",
                                    "chart_file": "charts/prediction_chart_DOGEUSDT.png"
                        },
                        "ADAUSDT": {
                                    "upside_prob": "46.7%",
                                    "vol_amp_prob": "16.7%",
                                    "chart_file": "charts/prediction_chart_ADAUSDT.png"
                        }
            }
};

        // 预测数据现在直接在HTML中更新，无需异步加载
        function loadPredictionsData() {
            console.log('使用内嵌预测数据:', predictionsData);
        }

        // 更新显示的数据
        function updateDisplay(symbol) {
            if (predictionsData.symbols && predictionsData.symbols[symbol]) {
                const data = predictionsData.symbols[symbol];

                // 更新指标
                document.getElementById('upside-prob').textContent = data.upside_prob || 'N/A';
                document.getElementById('vol-amp-prob').textContent = data.vol_amp_prob || 'N/A';

                // 更新图表
                if (data.chart_file) {
                    document.getElementById('chart-img').src = data.chart_file;
                    document.getElementById('chart-img').alt = `${symbol} Price and Volume Forecast Chart`;
                }

                // 更新页面标题中的币种名称
                const title = document.querySelector('title');
                title.textContent = `Kronos Live Forecast | ${symbol}`;

                console.log(`显示已更新为 ${symbol}:`, data);
            } else {
                console.warn(`未找到 ${symbol} 的预测数据`);
                // 显示默认或错误状态
                document.getElementById('upside-prob').textContent = 'N/A';
                document.getElementById('vol-amp-prob').textContent = 'N/A';
            }
        }

        // 处理币种选择变化
        function handleSymbolChange() {
            const select = document.getElementById('symbol-select');
            const selectedSymbol = select.value;
            updateDisplay(selectedSymbol);

            // 保存用户选择到localStorage
            localStorage.setItem('selectedSymbol', selectedSymbol);
        }

        // 页面加载完成时的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成，初始化币种选择功能');

            // 设置事件监听器
            const symbolSelect = document.getElementById('symbol-select');
            symbolSelect.addEventListener('change', handleSymbolChange);

            // 更新时间戳
            document.getElementById('update-time').textContent = predictionsData.last_updated;

            // 恢复用户之前的选择
            const savedSymbol = localStorage.getItem('selectedSymbol');
            if (savedSymbol && predictionsData.symbols[savedSymbol]) {
                symbolSelect.value = savedSymbol;
                updateDisplay(savedSymbol);
                console.log(`恢复之前选择的币种: ${savedSymbol}`);
            } else {
                // 默认显示第一个币种 (BNBUSDT)
                updateDisplay(symbolSelect.value);
                console.log(`显示默认币种: ${symbolSelect.value}`);
            }

            // 加载预测数据
            loadPredictionsData();
            const currentSymbol = document.getElementById('symbol-select').value;
            updateDisplay(currentSymbol);
        });
    </script>
</body>
</html>